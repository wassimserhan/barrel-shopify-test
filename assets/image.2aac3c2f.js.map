{"version":3,"file":"image.2aac3c2f.js","sources":["../node_modules/.pnpm/layzr.js@2.2.2/node_modules/layzr.js/dist/layzr.module.js","../modules/image/image.js"],"sourcesContent":["var _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar knot = function knot() {\n  var extended = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var events = Object.create(null);\n\n  function on(name, handler) {\n    events[name] = events[name] || [];\n    events[name].push(handler);\n    return this;\n  }\n\n  function once(name, handler) {\n    handler._once = true;\n    on(name, handler);\n    return this;\n  }\n\n  function off(name) {\n    var handler = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    handler ? events[name].splice(events[name].indexOf(handler), 1) : delete events[name];\n\n    return this;\n  }\n\n  function emit(name) {\n    var _this = this;\n\n    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    // cache the events, to avoid consequences of mutation\n    var cache = events[name] && events[name].slice();\n\n    // only fire handlers if they exist\n    cache && cache.forEach(function (handler) {\n      // remove handlers added with 'once'\n      handler._once && off(name, handler);\n\n      // set 'this' context, pass args to handlers\n      handler.apply(_this, args);\n    });\n\n    return this;\n  }\n\n  return _extends({}, extended, {\n\n    on: on,\n    once: once,\n    off: off,\n    emit: emit\n  });\n};\n\nvar layzr = (function () {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  // private\n\n  var prevLoc = getLoc();\n  var ticking = void 0;\n\n  var nodes = void 0;\n  var windowHeight = void 0;\n\n  // options\n\n  var settings = {\n    normal: options.normal || 'data-normal',\n    retina: options.retina || 'data-retina',\n    srcset: options.srcset || 'data-srcset',\n    threshold: options.threshold || 0\n  };\n\n  // feature detection\n  // https://github.com/Modernizr/Modernizr/blob/master/feature-detects/img/srcset.js\n\n  var srcset = document.body.classList.contains('srcset') || 'srcset' in document.createElement('img');\n\n  // device pixel ratio\n  // not supported in IE10 - https://msdn.microsoft.com/en-us/library/dn265030(v=vs.85).aspx\n\n  var dpr = window.devicePixelRatio || window.screen.deviceXDPI / window.screen.logicalXDPI;\n\n  // instance\n\n  var instance = knot({\n    handlers: handlers,\n    check: check,\n    update: update\n  });\n\n  return instance;\n\n  // location helper\n\n  function getLoc() {\n    return window.scrollY || window.pageYOffset;\n  }\n\n  // debounce helpers\n\n  function requestScroll() {\n    prevLoc = getLoc();\n    requestFrame();\n  }\n\n  function requestFrame() {\n    if (!ticking) {\n      window.requestAnimationFrame(function () {\n        return check();\n      });\n      ticking = true;\n    }\n  }\n\n  // offset helper\n\n  function getOffset(node) {\n    return node.getBoundingClientRect().top + prevLoc;\n  }\n\n  // in viewport helper\n\n  function inViewport(node) {\n    var viewTop = prevLoc;\n    var viewBot = viewTop + windowHeight;\n\n    var nodeTop = getOffset(node);\n    var nodeBot = nodeTop + node.offsetHeight;\n\n    var offset = settings.threshold / 100 * windowHeight;\n\n    return nodeBot >= viewTop - offset && nodeTop <= viewBot + offset;\n  }\n\n  // source helper\n\n  function setSource(node) {\n    instance.emit('src:before', node);\n\n    // prefer srcset, fallback to pixel density\n    if (srcset && node.hasAttribute(settings.srcset)) {\n      node.setAttribute('srcset', node.getAttribute(settings.srcset));\n    } else {\n      var retina = dpr > 1 && node.getAttribute(settings.retina);\n      node.setAttribute('src', retina || node.getAttribute(settings.normal));\n    }\n\n    instance.emit('src:after', node);[settings.normal, settings.retina, settings.srcset].forEach(function (attr) {\n      return node.removeAttribute(attr);\n    });\n\n    update();\n  }\n\n  // API\n\n  function handlers(flag) {\n    var action = flag ? 'addEventListener' : 'removeEventListener';['scroll', 'resize'].forEach(function (event) {\n      return window[action](event, requestScroll);\n    });\n    return this;\n  }\n\n  function check() {\n    windowHeight = window.innerHeight;\n\n    nodes.forEach(function (node) {\n      return inViewport(node) && setSource(node);\n    });\n\n    ticking = false;\n    return this;\n  }\n\n  function update() {\n    nodes = Array.prototype.slice.call(document.querySelectorAll('[' + settings.normal + ']'));\n    return this;\n  }\n});\n\nexport default layzr;\n","import on from 'dom-event'\nimport Layzr from 'layzr.js'\n\n// Check if object fit is supported\nlet objectFit = false\nfor (let prop in document.documentElement.style) {\n  if (/object(?:-f|F)it$/.test(prop)) {\n    objectFit = true\n    break\n  }\n}\n\n// Setup LazyLoad\nconst instance = Layzr({\n  normal: 'data-normal',\n  retina: 'data-retina',\n  srcset: 'data-srcset',\n  threshold: 0\n})\n\ninstance\n  .on('src:before', image => {\n    on(image, 'load', (event) => {\n      let wrapper = image.parentNode\n      wrapper.classList.add('is-loaded')\n    })\n  })\n\nconst objectFitShim = (el) => {\n  // We'll compare the aspect ratio of media items with the aspect ratio of the parent container to decide how\n  const elAspect = el.clientHeight / el.clientWidth\n  const elMediaItems = el.querySelectorAll('img,video')\n\n  // We need to hide overflow for the shim to properly replicate object-fit:cover\n  el.style.overflow = 'hidden'\n\n  // Grab each media-item and adjust its class-names\n  for (var i = 0; i < elMediaItems.length; i++) {\n    let mediaItem = elMediaItems[i]\n    let mediaAspect = mediaItem.clientHeight / mediaItem.clientWidth\n    let mediaClass = mediaItem.getAttribute('data-js-class')\n\n    mediaItem.className = mediaItem.className.replace(mediaClass, mediaClass + '--shim')\n\n    setTimeout(() => { // TODO: how to handle transforms\n      // add a class to some things that can make them transform\n    }, 10)\n\n    // Establish which edge of the mdia will hit container last (horizontal or vertical)\n    // This is used specifically for the object-fit:cover shim, but both max-width:100%\n    // and max-height:100% are necessary (and already established) for the\n    // object-fit:contain shim, so why build the logic to scope it?\n    if (mediaAspect < elAspect) {\n      mediaItem.style.maxWidth = '100%'\n    }\n    if (mediaAspect >= elAspect) {\n      mediaItem.style.maxHeight = '100%'\n    }\n  }\n}\nexport default (el) => {\n  instance\n    .update()\n    .check()\n    .handlers(true)\n\n  if (objectFit) {\n    return\n  }\n\n  objectFitShim(el)\n}\n"],"names":["_extends","target","i","source","key","knot","extended","events","on","name","handler","once","off","emit","_this","_len","args","_key","cache","layzr","options","prevLoc","getLoc","ticking","nodes","windowHeight","settings","srcset","dpr","instance","handlers","check","update","requestScroll","requestFrame","getOffset","node","inViewport","viewTop","viewBot","nodeTop","nodeBot","offset","setSource","retina","attr","flag","action","event","Layzr","objectFit","prop","image","objectFitShim","el","elAspect","elMediaItems","mediaItem","mediaAspect","mediaClass"],"mappings":"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","x_google_ignoreList":[0]}