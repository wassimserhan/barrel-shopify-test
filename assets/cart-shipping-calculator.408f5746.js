import{l as f}from"./index.a394a8ae.js";import{n as h}from"./index.4dec3c6a.js";import"./_commonjsHelpers.de833af9.js";const v=e=>{let t="",n=Object.keys(e);for(let r=0;r<n.length;r++){let s=n[r],o=e[s];t+=`${encodeURIComponent(`shipping_address[${s}]`)}=${encodeURIComponent(o)}${r<n.length-1?"&":""}`}return t},S=(e,t,n)=>h.ajax({method:"post",url:e,body:v(t)},n),$=(e,t)=>h.ajax({url:e},t),C=e=>{const t=JSON.parse(e).shipping_rates;return t?t.map(n=>({type:n.name,price:n.price})):null},E=e=>{const t=JSON.parse(e),n=Object.keys(t);let r="";for(let s=0;s<n.length;s++){let o=n[s];r+=`Error: ${o} ${t[o][0]}${s!==n.length-1?", ":""}`}return r},j=(e=null)=>{if(!e)return;let t=document.createElement("option");return t.value=e,t.innerHTML=e,t},L=(e,t)=>[].slice.call(t.options).map((n,r)=>{n.value===e&&(t.selectedIndex=r)}),m=(e,t,n=null)=>{const r=e.options[0]?e.options[0].value:!1;return t=Array.isArray(t)?t:Object.keys(t),(!r||t[0]!==r)&&(e.innerHTML="",t.forEach(o=>e.appendChild(j(o)))),n&&L(n,e),e.value};if(typeof window.Countries!="object")throw new Error("The global Countries object required by your shipping calculator does not exist.");const T=(e,t={})=>{const n=t.defaultCountry||null,r=t.endpoints||{prepare:"/cart/prepare_shipping_rates",get:"/cart/async_shipping_rates"},s=e.querySelector('[name="country"]'),o=e.querySelector('[name="province"]'),p=e.querySelector('[name="zip"]'),l=e.querySelector('[type="submit"]'),c={get country(){return s.value},get province(){return o.value},get zip(){return p.value},get meta(){return Countries[this.country]}},i=Object.create(f(),{getState:{value:()=>c}});return s.addEventListener("change",a=>{let{provinces:u,zip_required:d}=Countries[c.country];u?(m(o,u),o.disabled=!1):(o.innerHTML="",o.disabled=!0),d?p.disabled=!1:p.disabled=!0,i.emit("change",c)}),e.addEventListener("submit",a=>{a.preventDefault(),a.returnValue=!1,i.emit("submit",c),l.disabled=!0,S(r.prepare,c,(u,d,q)=>{if(u>=200&&u<=300)$(r.get,(y,g,O)=>{let b=C(g);i.emit("success",b)});else{let y=E(d);i.emit("error",y)}l.disabled=!1})}),m(s,Countries,n),m(o,Countries[n||Object.keys(Countries)[0]].provinces),i},H=e=>{const t=e,n=document.getElementById("shippingResults"),r=document.getElementById("shippingProvince"),s=document.getElementById("shippingZip"),o=r.getElementsByTagName("label")[0],p=s.getElementsByTagName("label")[0],l=T(t,{defaultCountry:"United States"});window.shipper=l;const c=i=>n.innerHTML=`
    <div>
      <p class="italic">There ${i.length>1?`are ${i.length} rates`:`is ${i.length} rate`} available:</p>
      <p class="p0">
      ${i.map(a=>`<span class="bold">${a.type}:</span><span>$${a.price}</span><br>`).join("")}
      </p>
    </div>
  `;l.on("success",c),l.on("error",i=>console.warn(i)),l.on("change",i=>{let a=i.meta;n.innerHTML="",i.province?r.style.display="block":r.style.display="none",a.zip_required?s.style.display="block":s.style.display="none",p.innerHTML=`${a.zip_label}:`,o.innerHTML=`${a.province_label}:`})};export{H as default};
